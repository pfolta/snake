!function e(t,n,a){function i(s,o){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!o&&u)return u(s,!0);if(r)return r(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[s]={exports:{}};t[s][0].call(h.exports,function(e){var n=t[s][1][e];return i(n||e)},h,h.exports,e,t,n,a)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<a.length;s++)i(a[s]);return i}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=s(e("./tile")),r=s(e("./util/random"));function s(e){return e&&e.__esModule?e:{default:e}}var o=e("./game_config"),u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"spawnApple",value:function(e){for(var t=[],n=0;n<o.Y_TILES;n++)for(var a=0;a<o.X_TILES;a++){var s=new i.default(a,n);e.collidesWith(s)||t.push(s)}var u=r.default.random(t);return new i.default(u.x,u.y)}}]),e}();n.default=u},{"./game_config":5,"./tile":10,"./util/random":13}],2:[function(e,t,n){"use strict";var a=l(e("./canvas_handler")),i=l(e("./game")),r=l(e("./keyboard_handler")),s=l(e("./storage_handler")),o=l(e("./touch_handler")),u=l(e("./ui_handler"));function l(e){return e&&e.__esModule?e:{default:e}}var h=new s.default,c=new i.default(h);new a.default("js-snake-canvas",c),new r.default(c),new o.default("js-snake-canvas",c);var d=new u.default(c);c.registerUiHandler(d),c.newGame()},{"./canvas_handler":3,"./game":4,"./keyboard_handler":6,"./storage_handler":9,"./touch_handler":11,"./ui_handler":12}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=e("./tile"),s=(a=r)&&a.__esModule?a:{default:a};var o=e("./game_config"),u=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=document.getElementById(t),this.gc=this.canvas.getContext("2d"),this.game=n,this.uiControls=document.getElementById("js-ui-controls"),this.appleImage=document.getElementById("js-asset-apple"),this.appleAnimationScale=100,this.appleAnimationDirection=1,this.recomputeCanvas(),window.addEventListener("resize",function(){return a.recomputeCanvas()}),window.addEventListener("orientationchange",function(){return a.recomputeCanvas()}),window.requestAnimationFrame(function(){return a.draw()})}return i(e,[{key:"recomputeCanvas",value:function(){this.resizeCanvas(),this.canvas.width=Math.floor(this.canvas.clientWidth/o.X_TILES)*o.X_TILES*2,this.canvas.height=Math.floor(this.canvas.clientHeight/o.Y_TILES)*o.Y_TILES*2,this.tileWidth=Math.floor(this.canvas.width/o.X_TILES),this.tileHeight=Math.floor(this.canvas.height/o.Y_TILES)}},{key:"resizeCanvas",value:function(){var e=document.documentElement.clientWidth,t=document.documentElement.clientHeight-this.uiControls.clientHeight,n=void 0;n=e<t?e:t,n+="px",this.canvas.style.width=n,this.canvas.style.height=n}},{key:"draw",value:function(){var e=this;this.drawBackground(),null!=this.game.apple&&this.drawApple(this.game.apple,this.game.paused),null!=this.game.snake&&this.drawSnake(this.game.snake),window.setTimeout(function(){return window.requestAnimationFrame(function(){return e.draw()})},1e3/o.REFRESH_FPS)}},{key:"drawBackground",value:function(){for(var e=0;e<o.X_TILES;e++)for(var t=0;t<o.Y_TILES;t++){var n=new s.default(e,t),a=void 0;a=(e+t)%2==0?o.BACKGROUND_COLOR_1:o.BACKGROUND_COLOR_2,this.gc.fillStyle=a,this.drawTile(n)}}},{key:"drawSnake",value:function(e){this.gc.fillStyle=o.SNAKE_COLOR;for(var t=0;t<e.snake.length;t++)this.drawTile(e.snake[t])}},{key:"drawApple",value:function(e,t){t?this.drawImageOnTile(this.appleImage,e):this.animateApple(e)}},{key:"animateApple",value:function(e){1==this.appleAnimationDirection?this.appleAnimationScale<120?this.appleAnimationScale+=1:this.appleAnimationDirection=-1:this.appleAnimationScale>80?this.appleAnimationScale-=1:this.appleAnimationDirection=1,this.drawImageOnTileWithScaleFactor(this.appleImage,e,.01*this.appleAnimationScale)}},{key:"drawImageOnTile",value:function(e,t){this.drawImageOnTileWithScaleFactor(e,t,1)}},{key:"drawImageOnTileWithScaleFactor",value:function(e,t,n){var a=t.x*this.tileWidth,i=t.y*this.tileHeight,r=this.tileWidth*n,s=this.tileHeight*n,o=a-(r-this.tileWidth)/2,u=i-(s-this.tileHeight)/2;this.gc.drawImage(e,o,u,r,s)}},{key:"drawTile",value:function(e){var t=e.x*this.tileWidth,n=e.y*this.tileHeight;this.gc.fillRect(t,n,this.tileWidth,this.tileHeight)}}]),e}();n.default=u},{"./game_config":5,"./tile":10}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=o(e("./apple")),r=o(e("./snake")),s=o(e("./tile"));function o(e){return e&&e.__esModule?e:{default:e}}var u=e("./game_config"),l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.HIGHSCORE_STORAGE_KEY="highscore",this.storageHandler=t,this.readStorageContents()}return a(e,[{key:"registerUiHandler",value:function(e){this.uiHandler=e}},{key:"readStorageContents",value:function(){this.highscore=this.storageHandler.get(this.HIGHSCORE_STORAGE_KEY,0)}},{key:"newGame",value:function(){this.score=0,this.paused=!0,this.gameover=!1,this.snake=new r.default,this.apple=i.default.spawnApple(this.snake),this.dx=1,this.dy=0,this.uiHandler.updateUiControls()}},{key:"startPauseGame",value:function(){this.paused?this.startGame():this.pauseGame()}},{key:"startGame",value:function(){var e=this;this.gameover||this.paused&&(this.paused=!1,this.gameInterval=window.setInterval(function(){return e.game()},1e3/u.GAME_SPEED))}},{key:"pauseGame",value:function(){this.paused=!0,window.clearInterval(this.gameInterval)}},{key:"endGame",value:function(){this.pauseGame(),this.gameover=!0,this.uiHandler.showGameOverScreen()}},{key:"left",value:function(){this.paused&&this.startGame(),1!=this.snake.head().dx&&(this.dx=-1,this.dy=0)}},{key:"up",value:function(){this.paused&&this.startGame(),1!=this.snake.head().dy&&(this.startGame(),this.dx=0,this.dy=-1)}},{key:"right",value:function(){this.paused&&this.startGame(),-1!=this.snake.head().dx&&(this.startGame(),this.dx=1,this.dy=0)}},{key:"down",value:function(){this.paused&&this.startGame(),-1!=this.snake.head().dy&&(this.startGame(),this.dx=0,this.dy=1)}},{key:"game",value:function(){return u.ENABLE_WALLS&&this.snake.aboutToCollideWithWalls(this.dx,this.dy)?this.endGame():(s.default.collides(this.snake.head(),this.apple)&&(this.snake.eatApple(),this.apple=i.default.spawnApple(this.snake),this.increaseScore(1)),this.snake.move(this.dx,this.dy),this.snake.loopThroughWalls(),this.snake.collidesWithItself()?this.endGame():void 0)}},{key:"increaseScore",value:function(e){this.score+=e,this.score>this.highscore&&this.setHighscore(this.score),this.uiHandler.updateUiControls()}},{key:"setHighscore",value:function(e){this.highscore=e,this.storageHandler.set(this.HIGHSCORE_STORAGE_KEY,this.highscore),this.uiHandler.updateUiControls()}},{key:"resetHighscore",value:function(){this.setHighscore(0)}}]),e}();n.default=l},{"./apple":1,"./game_config":5,"./snake":7,"./tile":10}],5:[function(e,t,n){"use strict";t.exports={ENABLE_WALLS:!0,INITIAL_SNAKE_SIZE:5,X_TILES:21,Y_TILES:21,BACKGROUND_COLOR_1:"#aed75b",BACKGROUND_COLOR_2:"#9fd24a",SNAKE_COLOR:"purple",GAME_SPEED:7,REFRESH_FPS:60}},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,window.addEventListener("keydown",function(e){return n.handleKeyEvent(e)})}return a(e,[{key:"handleKeyEvent",value:function(e){switch(e.key){case" ":case"Escape":case"Esc":case"p":this.game.startPauseGame();break;case"ArrowLeft":case"Left":case"a":this.game.left();break;case"ArrowUp":case"Up":case"w":this.game.up();break;case"ArrowRight":case"Right":case"d":this.game.right();break;case"ArrowDown":case"Down":case"s":this.game.down()}}}]),e}();n.default=i},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=s(e("./snake_body")),r=s(e("./tile"));function s(e){return e&&e.__esModule?e:{default:e}}var o=e("./game_config"),u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.snake=[];var t=new i.default;t.x=o.INITIAL_SNAKE_SIZE-1,t.y=Math.floor(o.Y_TILES/2),t.dx=1,t.dy=0,this.append(t);for(var n=1;n<o.INITIAL_SNAKE_SIZE;n++)this.append(new i.default(this.head().x-n,this.head().y,this.head().dx,this.head().dy))}return a(e,[{key:"head",value:function(){return this.snake[0]}},{key:"tail",value:function(){return this.snake[this.snake.length-1]}},{key:"move",value:function(e,t){this.prepend(new i.default(this.head().x+e,this.head().y+t,e,t)),this.dropLast()}},{key:"append",value:function(e){this.snake.push(e)}},{key:"prepend",value:function(e){this.snake.unshift(e)}},{key:"dropLast",value:function(){this.snake.pop()}},{key:"collidesWith",value:function(e){return this.bodyCollidesWith(e)||r.default.collides(this.head(),e)}},{key:"bodyCollidesWith",value:function(e){if(this.snake.length<2)return!1;for(var t=1;t<this.snake.length;t++)if(r.default.collides(this.snake[t],e))return!0;return!1}},{key:"collidesWithItself",value:function(){return this.bodyCollidesWith(this.head())}},{key:"loopThroughWalls",value:function(){this.head().x<0&&(this.snake[0].x=o.X_TILES-1),this.head().x>=o.X_TILES&&(this.snake[0].x=0),this.head().y<0&&(this.snake[0].y=o.Y_TILES-1),this.head().y>=o.Y_TILES&&(this.snake[0].y=0)}},{key:"aboutToCollideWithWalls",value:function(e,t){return this.head().x+e<0||(this.head().x+e>=o.X_TILES||(this.head().y+t<0||this.head().y+t>=o.Y_TILES))}},{key:"eatApple",value:function(){var e=this.tail();this.append(new i.default(e.x+e.dx,e.y+e.dy,e.dx,e.dy))}}]),e}();n.default=u},{"./game_config":5,"./snake_body":8,"./tile":10}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,i=e("./tile"),r=(a=i)&&a.__esModule?a:{default:a};var s=function(e){function t(e,n,a,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.dx=a,r.dy=i,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),t}();n.default=s},{"./tile":10}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.KEY_PREFIX="snake",this.KEY_SEPARATOR="###"}return a(e,[{key:"get",value:function(e,t){return window.localStorage.getItem(this.KEY_PREFIX+this.KEY_SEPARATOR+e)||t}},{key:"set",value:function(e,t){window.localStorage.setItem(this.KEY_PREFIX+this.KEY_SEPARATOR+e,t)}}]),e}();n.default=i},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=e("./util/random"),s=(a=r)&&a.__esModule?a:{default:a};var o=e("./game_config"),u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),null==t&&null==n?this.randomize():(this.x=t,this.y=n)}return i(e,null,[{key:"collides",value:function(e,t){return e.x===t.x&&e.y===t.y}}]),i(e,[{key:"randomize",value:function(){this.x=s.default.random(o.X_TILES),this.y=s.default.random(o.Y_TILES)}}]),e}();n.default=u},{"./game_config":5,"./util/random":13}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=document.getElementById(t),this.game=n,n.touchStartX=null,n.touchStartY=null,n.touchMoveX=null,n.touchMoveY=null,this.canvas.addEventListener("touchstart",function(e){return a.handleTouchStart(e)},!1),this.canvas.addEventListener("touchmove",function(e){return a.handleTouchMove(e)},!1)}return a(e,[{key:"handleTouchStart",value:function(e){this.touchStartX=e.touches[0].clientX,this.touchStartY=e.touches[0].clientY}},{key:"handleTouchMove",value:function(e){null!=this.touchStartX&&null!=this.touchStartY&&(this.touchMoveX=e.touches[0].clientX,this.touchMoveY=e.touches[0].clientY,this.handleTouchGesture(),this.touchStartX=this.touchMoveX,this.touchStartY=this.touchMoveY)}},{key:"handleTouchGesture",value:function(){var e=this.touchMoveX-this.touchStartX,t=this.touchMoveY-this.touchStartY;Math.abs(e)>Math.abs(t)?e<0?this.game.left():e>0&&this.game.right():Math.abs(e)<Math.abs(t)&&(t<0?this.game.up():t>0&&this.game.down())}}]),e}();n.default=i},{}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.gameWasRunning=!1,this.uiControls={OVERLAY:document.getElementById("js-overlay"),GAMEOVER_SCREEN:document.getElementById("js-gameover-screen"),GAMEOVER_SCREEN_BUTTON:document.getElementById("js-gameover-screen-button"),UI_CONTROLS_BAR:document.getElementById("js-ui-controls"),SCORE_LABEL:document.getElementById("js-score"),HIGHSCORE_LABEL:document.getElementById("js-highscore"),MENU_BUTTON:document.getElementById("js-menu-button"),MENU:document.getElementById("js-menu"),MENU_RESET_HIGHSCORE:document.getElementById("js-menu-reset-highscore")},this.setUpEventHandlers()}return a(e,[{key:"setUpEventHandlers",value:function(){var e=this;this.uiControls.GAMEOVER_SCREEN_BUTTON.addEventListener("click",function(){return e.newGame()}),this.uiControls.MENU_BUTTON.addEventListener("click",function(){return e.showMenu()}),this.uiControls.MENU_RESET_HIGHSCORE.addEventListener("click",function(){return e.resetHighscore()})}},{key:"updateUiControls",value:function(){this.updateScore(),this.updateHighscore()}},{key:"updateScore",value:function(){this.uiControls.SCORE_LABEL.innerHTML=this.game.score}},{key:"updateHighscore",value:function(){this.uiControls.HIGHSCORE_LABEL.innerHTML=this.game.highscore}},{key:"resetHighscore",value:function(){this.game.resetHighscore(),this.hideMenu()}},{key:"showOverlay",value:function(e){this.uiControls.OVERLAY.classList.add("overlay-shown"),null!=e&&this.uiControls.OVERLAY.addEventListener("click",e)}},{key:"hideOverlay",value:function(){this.uiControls.OVERLAY.classList.remove("overlay-shown");var e=this.uiControls.OVERLAY.cloneNode(!0);this.uiControls.OVERLAY.parentNode.replaceChild(e,this.uiControls.OVERLAY),this.uiControls.OVERLAY=e}},{key:"showMenu",value:function(){var e=this;this.gameWasRunning=!this.game.paused,this.game.pauseGame(),this.showOverlay(function(){return e.hideMenu()}),this.uiControls.MENU.classList.add("menu-shown")}},{key:"hideMenu",value:function(){this.hideOverlay(),this.uiControls.MENU.classList.remove("menu-shown"),this.gameWasRunning&&this.game.startGame()}},{key:"showGameOverScreen",value:function(){this.showOverlay(),this.uiControls.GAMEOVER_SCREEN.classList.add("gameover-screen-shown")}},{key:"newGame",value:function(){this.hideOverlay(),this.uiControls.GAMEOVER_SCREEN.classList.remove("gameover-screen-shown"),this.game.newGame()}}]),e}();n.default=i},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"randomInt",value:function(e,t){return Math.floor(Math.random()*(t-e)+e)}},{key:"randomArrayElement",value:function(t){return t[e.random(t.length)]}},{key:"random",value:function(){return 1==arguments.length&&arguments[0]instanceof Array?e.randomArrayElement(arguments[0]):1==arguments.length&&"number"==typeof arguments[0]?e.randomInt(0,arguments[0]):2==arguments.length&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]?e.randomInt(arguments[0],arguments[1]):Math.random()}}]),e}();n.default=i},{}]},{},[2]);