!function r(s,o,u){function l(t,e){if(!o[t]){if(!s[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(h)return h(t,!0);var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}var i=o[t]={exports:{}};s[t][0].call(i.exports,function(e){return l(s[t][1][e]||e)},i,i.exports,r,s,o,u)}return o[t].exports}for(var h="function"==typeof require&&require,e=0;e<u.length;e++)l(u[e]);return l}({1:[function(e,t,n){"use strict";var a=l(e("./canvas_handler")),i=l(e("./game")),r=l(e("./keyboard_handler")),s=l(e("./storage_handler")),o=l(e("./touch_handler")),u=l(e("./ui_handler"));function l(e){return e&&e.__esModule?e:{default:e}}var h=new s.default,c=new i.default(h);new a.default("js-snake-canvas",c),new r.default(c),new o.default("js-snake-canvas",c);var d=new u.default(c);c.registerUiHandler(d),c.newGame()},{"./canvas_handler":2,"./game":4,"./keyboard_handler":5,"./storage_handler":10,"./touch_handler":11,"./ui_handler":12}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),r=a(e("./core/config")),s=a(e("./model/tile"));function a(e){return e&&e.__esModule?e:{default:e}}var o=function(){function a(e,t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.canvas=document.getElementById(e),this.gc=this.canvas.getContext("2d"),this.game=t,this.uiControls=document.getElementById("js-ui-controls"),this.appleImage=document.getElementById("js-asset-apple"),this.appleAnimationScale=100,this.appleAnimationDirection=1,this.recomputeCanvas(),window.addEventListener("resize",function(){return n.recomputeCanvas()}),window.addEventListener("orientationchange",function(){return n.recomputeCanvas()}),window.requestAnimationFrame(function(){return n.draw()})}return i(a,[{key:"recomputeCanvas",value:function(){this.resizeCanvas(),this.canvas.width=Math.floor(this.canvas.clientWidth/r.default.X_TILES)*r.default.X_TILES*2,this.canvas.height=Math.floor(this.canvas.clientHeight/r.default.Y_TILES)*r.default.Y_TILES*2,this.tileWidth=Math.floor(this.canvas.width/r.default.X_TILES),this.tileHeight=Math.floor(this.canvas.height/r.default.Y_TILES)}},{key:"resizeCanvas",value:function(){var e=document.documentElement.clientWidth,t=document.documentElement.clientHeight-this.uiControls.clientHeight,n=Math.min(e,t)+"px";this.canvas.style.width=n,this.canvas.style.height=n}},{key:"draw",value:function(){var e=this;this.drawBackground(),null!=this.game.apple&&this.drawApple(this.game.apple,this.game.paused),null!=this.game.snake&&this.drawSnake(this.game.snake),window.setTimeout(function(){return window.requestAnimationFrame(function(){return e.draw()})},1e3/r.default.REFRESH_FPS)}},{key:"drawBackground",value:function(){for(var e=0;e<r.default.X_TILES;e++)for(var t=0;t<r.default.Y_TILES;t++){var n=new s.default(e,t),a=void 0;a=(e+t)%2==0?r.default.BACKGROUND_COLOR_1:r.default.BACKGROUND_COLOR_2,this.gc.fillStyle=a,this.drawTile(n)}}},{key:"drawSnake",value:function(e){this.gc.fillStyle=r.default.SNAKE_COLOR;for(var t=0;t<e.snake.length;t++)this.drawTile(e.snake[t])}},{key:"drawApple",value:function(e,t){t?this.drawImageOnTile(this.appleImage,e):this.animateApple(e)}},{key:"animateApple",value:function(e){1==this.appleAnimationDirection?this.appleAnimationScale<120?this.appleAnimationScale+=1:this.appleAnimationDirection=-1:80<this.appleAnimationScale?this.appleAnimationScale-=1:this.appleAnimationDirection=1,this.drawImageOnTileWithScaleFactor(this.appleImage,e,.01*this.appleAnimationScale)}},{key:"drawImageOnTile",value:function(e,t){this.drawImageOnTileWithScaleFactor(e,t,1)}},{key:"drawImageOnTileWithScaleFactor",value:function(e,t,n){var a=t.x*this.tileWidth,i=t.y*this.tileHeight,r=this.tileWidth*n,s=this.tileHeight*n,o=a-(r-this.tileWidth)/2,u=i-(s-this.tileHeight)/2;this.gc.drawImage(e,o,u,r,s)}},{key:"drawTile",value:function(e){var t=e.x*this.tileWidth,n=e.y*this.tileHeight;this.gc.fillRect(t,n,this.tileWidth,this.tileHeight)}}]),a}();n.default=o},{"./core/config":3,"./model/tile":9}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={ENABLE_WALLS:!0,INITIAL_SNAKE_SIZE:5,X_TILES:21,Y_TILES:21,BACKGROUND_COLOR_1:"#aed75b",BACKGROUND_COLOR_2:"#9fd24a",SNAKE_COLOR:"purple",GAME_SPEED:7,REFRESH_FPS:60}},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),i=u(e("./model/apple")),r=u(e("./core/config")),s=u(e("./model/snake")),o=u(e("./model/tile"));function u(e){return e&&e.__esModule?e:{default:e}}var l=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.HIGHSCORE_STORAGE_KEY="highscore",this.storageHandler=e,this.readStorageContents()}return a(t,[{key:"registerUiHandler",value:function(e){this.uiHandler=e}},{key:"readStorageContents",value:function(){this.highscore=this.storageHandler.get(this.HIGHSCORE_STORAGE_KEY,0)}},{key:"newGame",value:function(){this.score=0,this.paused=!0,this.gameover=!1,this.snake=new s.default,this.apple=i.default.spawnApple(this.snake),this.dx=1,this.dy=0,this.uiHandler.updateUiControls()}},{key:"startPauseGame",value:function(){this.paused?this.startGame():this.pauseGame()}},{key:"startGame",value:function(){var e=this;this.gameover||this.paused&&(this.paused=!1,this.gameInterval=window.setInterval(function(){return e.game()},1e3/r.default.GAME_SPEED))}},{key:"pauseGame",value:function(){this.paused=!0,window.clearInterval(this.gameInterval)}},{key:"endGame",value:function(){this.pauseGame(),this.gameover=!0,this.uiHandler.showGameOverScreen()}},{key:"left",value:function(){this.paused&&this.startGame(),1!=this.snake.head().dx&&(this.dx=-1,this.dy=0)}},{key:"up",value:function(){this.paused&&this.startGame(),1!=this.snake.head().dy&&(this.startGame(),this.dx=0,this.dy=-1)}},{key:"right",value:function(){this.paused&&this.startGame(),-1!=this.snake.head().dx&&(this.startGame(),this.dx=1,this.dy=0)}},{key:"down",value:function(){this.paused&&this.startGame(),-1!=this.snake.head().dy&&(this.startGame(),this.dx=0,this.dy=1)}},{key:"game",value:function(){return r.default.ENABLE_WALLS&&this.snake.aboutToCollideWithWalls(this.dx,this.dy)?this.endGame():(o.default.collides(this.snake.head(),this.apple)&&(this.snake.eatApple(),this.apple=i.default.spawnApple(this.snake),this.increaseScore(1)),this.snake.move(this.dx,this.dy),this.snake.loopThroughWalls(),this.snake.collidesWithItself()?this.endGame():void 0)}},{key:"increaseScore",value:function(e){this.score+=e,this.score>this.highscore&&this.setHighscore(this.score),this.uiHandler.updateUiControls()}},{key:"setHighscore",value:function(e){this.highscore=e,this.storageHandler.set(this.HIGHSCORE_STORAGE_KEY,this.highscore),this.uiHandler.updateUiControls()}},{key:"resetHighscore",value:function(){this.setHighscore(0)}}]),t}();n.default=l},{"./core/config":3,"./model/apple":6,"./model/snake":7,"./model/tile":9}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}();var i=function(){function n(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.game=e,window.addEventListener("keydown",function(e){return t.handleKeyEvent(e)})}return a(n,[{key:"handleKeyEvent",value:function(e){switch(e.key){case" ":case"Escape":case"Esc":case"p":this.game.startPauseGame();break;case"ArrowLeft":case"Left":case"a":this.game.left();break;case"ArrowUp":case"Up":case"w":this.game.up();break;case"ArrowRight":case"Right":case"d":this.game.right();break;case"ArrowDown":case"Down":case"s":this.game.down()}}}]),n}();n.default=i},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),r=i(e("../core/config")),s=i(e("../util/random")),o=i(e("./tile"));function i(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"spawnApple",value:function(e){for(var t=[],n=0;n<r.default.Y_TILES;n++)for(var a=0;a<r.default.X_TILES;a++){var i=new o.default(a,n);e.collidesWith(i)||t.push(i)}return(0,s.default)(t)}}]),e}();n.default=u},{"../core/config":3,"../util/random":13,"./tile":9}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),i=o(e("../core/config")),r=o(e("./snake_body")),s=o(e("./tile"));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.snake=[];var e=new r.default;e.x=i.default.INITIAL_SNAKE_SIZE-1,e.y=Math.floor(i.default.Y_TILES/2),e.dx=1,e.dy=0,this.append(e);for(var t=1;t<i.default.INITIAL_SNAKE_SIZE;t++)this.append(new r.default(this.head().x-t,this.head().y,this.head().dx,this.head().dy))}return a(n,[{key:"size",value:function(){return this.snake.length}},{key:"head",value:function(){return this.snake[0]}},{key:"tail",value:function(){return this.snake[this.snake.length-1]}},{key:"move",value:function(e,t){this.prepend(new r.default(this.head().x+e,this.head().y+t,e,t)),this.dropLast()}},{key:"append",value:function(e){this.snake.push(e)}},{key:"prepend",value:function(e){this.snake.unshift(e)}},{key:"dropLast",value:function(){this.snake.pop()}},{key:"collidesWith",value:function(e){return this.bodyCollidesWith(e)||s.default.collides(this.head(),e)}},{key:"bodyCollidesWith",value:function(e){if(this.snake.length<2)return!1;for(var t=1;t<this.snake.length;t++)if(s.default.collides(this.snake[t],e))return!0;return!1}},{key:"collidesWithItself",value:function(){return this.bodyCollidesWith(this.head())}},{key:"loopThroughWalls",value:function(){this.head().x<0&&(this.snake[0].x=i.default.X_TILES-1),this.head().x>=i.default.X_TILES&&(this.snake[0].x=0),this.head().y<0&&(this.snake[0].y=i.default.Y_TILES-1),this.head().y>=i.default.Y_TILES&&(this.snake[0].y=0)}},{key:"aboutToCollideWithWalls",value:function(e,t){return this.head().x+e<0||(this.head().x+e>=i.default.X_TILES||(this.head().y+t<0||this.head().y+t>=i.default.Y_TILES))}},{key:"eatApple",value:function(){var e=this.tail();this.append(new r.default(e.x+e.dx,e.y+e.dy,e.dx,e.dy))}}]),n}();n.default=u},{"../core/config":3,"./snake_body":8,"./tile":9}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a,i=e("./tile"),s=(a=i)&&a.__esModule?a:{default:a};var r=function(e){function r(e,t,n,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t));return i.dx=n,i.dy=a,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,s.default),r}();n.default=r},{"./tile":9}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}(),i=s(e("../core/config")),r=s(e("../util/random"));function s(e){return e&&e.__esModule?e:{default:e}}var o=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),null==e&&null==t?this.randomize():(this.x=e,this.y=t)}return a(n,null,[{key:"collides",value:function(e,t){return e.x===t.x&&e.y===t.y}}]),a(n,[{key:"randomize",value:function(){this.x=(0,r.default)(i.default.X_TILES),this.y=(0,r.default)(i.default.Y_TILES)}}]),n}();n.default=o},{"../core/config":3,"../util/random":13}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.KEY_PREFIX="snake",this.KEY_SEPARATOR="###"}return a(e,[{key:"get",value:function(e,t){return window.localStorage.getItem(this.KEY_PREFIX+this.KEY_SEPARATOR+e)||t}},{key:"set",value:function(e,t){window.localStorage.setItem(this.KEY_PREFIX+this.KEY_SEPARATOR+e,t)}}]),e}();n.default=i},{}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}();var a=function(){function a(e,t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.canvas=document.getElementById(e),(this.game=t).touchStartX=null,t.touchStartY=null,t.touchMoveX=null,t.touchMoveY=null,this.canvas.addEventListener("touchstart",function(e){return n.handleTouchStart(e)},!1),this.canvas.addEventListener("touchmove",function(e){return n.handleTouchMove(e)},!1)}return i(a,[{key:"handleTouchStart",value:function(e){this.touchStartX=e.touches[0].clientX,this.touchStartY=e.touches[0].clientY}},{key:"handleTouchMove",value:function(e){null!=this.touchStartX&&null!=this.touchStartY&&(this.touchMoveX=e.touches[0].clientX,this.touchMoveY=e.touches[0].clientY,this.handleTouchGesture(),this.touchStartX=this.touchMoveX,this.touchStartY=this.touchMoveY)}},{key:"handleTouchGesture",value:function(){var e=this.touchMoveX-this.touchStartX,t=this.touchMoveY-this.touchStartY;Math.abs(e)>Math.abs(t)?e<0?this.game.left():0<e&&this.game.right():Math.abs(e)<Math.abs(t)&&(t<0?this.game.up():0<t&&this.game.down())}}]),a}();n.default=a},{}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}();var i=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.game=e,this.gameWasRunning=!1,this.uiControls={OVERLAY:document.getElementById("js-overlay"),GAMEOVER_SCREEN:document.getElementById("js-gameover-screen"),GAMEOVER_SCREEN_BUTTON:document.getElementById("js-gameover-screen-button"),UI_CONTROLS_BAR:document.getElementById("js-ui-controls"),SCORE_LABEL:document.getElementById("js-score"),HIGHSCORE_LABEL:document.getElementById("js-highscore"),MENU_BUTTON:document.getElementById("js-menu-button"),MENU:document.getElementById("js-menu"),MENU_RESET_HIGHSCORE:document.getElementById("js-menu-reset-highscore")},this.setUpEventHandlers()}return a(t,[{key:"setUpEventHandlers",value:function(){var e=this;this.uiControls.GAMEOVER_SCREEN_BUTTON.addEventListener("click",function(){return e.newGame()}),this.uiControls.MENU_BUTTON.addEventListener("click",function(){return e.showMenu()}),this.uiControls.MENU_RESET_HIGHSCORE.addEventListener("click",function(){return e.resetHighscore()})}},{key:"updateUiControls",value:function(){this.updateScore(),this.updateHighscore()}},{key:"updateScore",value:function(){this.uiControls.SCORE_LABEL.innerHTML=this.game.score}},{key:"updateHighscore",value:function(){this.uiControls.HIGHSCORE_LABEL.innerHTML=this.game.highscore}},{key:"resetHighscore",value:function(){this.game.resetHighscore(),this.hideMenu()}},{key:"showOverlay",value:function(e){this.uiControls.OVERLAY.classList.add("overlay-shown"),null!=e&&this.uiControls.OVERLAY.addEventListener("click",e)}},{key:"hideOverlay",value:function(){this.uiControls.OVERLAY.classList.remove("overlay-shown");var e=this.uiControls.OVERLAY.cloneNode(!0);this.uiControls.OVERLAY.parentNode.replaceChild(e,this.uiControls.OVERLAY),this.uiControls.OVERLAY=e}},{key:"showMenu",value:function(){var e=this;this.gameWasRunning=!this.game.paused,this.game.pauseGame(),this.showOverlay(function(){return e.hideMenu()}),this.uiControls.MENU.classList.add("menu-shown")}},{key:"hideMenu",value:function(){this.hideOverlay(),this.uiControls.MENU.classList.remove("menu-shown"),this.gameWasRunning&&this.game.startGame()}},{key:"showGameOverScreen",value:function(){this.showOverlay(),this.uiControls.GAMEOVER_SCREEN.classList.add("gameover-screen-shown")}},{key:"newGame",value:function(){this.hideOverlay(),this.uiControls.GAMEOVER_SCREEN.classList.remove("gameover-screen-shown"),this.game.newGame()}}]),t}();n.default=i},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){var e=Math.random();if(1==arguments.length&&"number"==typeof arguments[0]){var t=arguments[0];return Math.floor(e*t)}if(1==arguments.length&&arguments[0]instanceof Array){var n=arguments[0];return n[Math.floor(e*n.length)]}if(2==arguments.length&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var a=arguments[0],i=arguments[1];return Math.floor(e*(i-a)+a)}return e}},{}]},{},[1]);