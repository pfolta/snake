!function e(t,n,i){function a(r,o){if(!n[r]){if(!t[r]){var u="function"==typeof require&&require;if(!o&&u)return u(r,!0);if(s)return s(r,!0);var h=new Error("Cannot find module '"+r+"'");throw h.code="MODULE_NOT_FOUND",h}var l=n[r]={exports:{}};t[r][0].call(l.exports,function(e){var n=t[r][1][e];return a(n||e)},l,l.exports,e,t,n,i)}return n[r].exports}for(var s="function"==typeof require&&require,r=0;r<i.length;r++)a(i[r]);return a}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,a=e("./tile"),s=(i=a)&&i.__esModule?i:{default:i};var r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e.collidesWith(n);)n.randomize();return n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),t}();n.default=r},{"./tile":10}],2:[function(e,t,n){"use strict";var i=h(e("./canvas_handler")),a=h(e("./game")),s=h(e("./keyboard_handler")),r=h(e("./storage_handler")),o=h(e("./touch_handler")),u=h(e("./ui_handler"));function h(e){return e&&e.__esModule?e:{default:e}}var l=new r.default,c=new a.default(l);new i.default("js-snake-canvas",c),new s.default(c),new o.default("js-snake-canvas",c);var d=new u.default(c);c.registerUiHandler(d),c.newGame()},{"./canvas_handler":3,"./game":4,"./keyboard_handler":6,"./storage_handler":9,"./touch_handler":11,"./ui_handler":12}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=e("./tile"),r=(i=s)&&i.__esModule?i:{default:i};var o=e("./game_config"),u=function(){function e(t,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=document.getElementById(t),this.gc=this.canvas.getContext("2d"),this.game=n,this.uiControls=document.getElementById("js-ui-controls"),this.appleImage=document.getElementById("js-asset-apple"),this.appleAnimationScale=100,this.appleAnimationDirection=1,this.recomputeCanvas(),window.addEventListener("resize",function(){return i.recomputeCanvas()}),window.addEventListener("orientationchange",function(){return i.recomputeCanvas()}),window.requestAnimationFrame(function(){return i.draw()})}return a(e,[{key:"recomputeCanvas",value:function(){this.resizeCanvas(),this.canvas.width=Math.floor(this.canvas.clientWidth/o.X_TILES)*o.X_TILES*2,this.canvas.height=Math.floor(this.canvas.clientHeight/o.Y_TILES)*o.Y_TILES*2,this.tileWidth=Math.floor(this.canvas.width/o.X_TILES),this.tileHeight=Math.floor(this.canvas.height/o.Y_TILES)}},{key:"resizeCanvas",value:function(){var e=document.documentElement.clientWidth,t=document.documentElement.clientHeight-this.uiControls.clientHeight,n=void 0;n=e<t?e:t,n+="px",this.canvas.style.width=n,this.canvas.style.height=n}},{key:"draw",value:function(){var e=this;this.drawBackground(),null!=this.game.apple&&this.drawApple(this.game.apple,this.game.paused),null!=this.game.snake&&this.drawSnake(this.game.snake),window.setTimeout(function(){return window.requestAnimationFrame(function(){return e.draw()})},1e3/o.REFRESH_FPS)}},{key:"drawBackground",value:function(){for(var e=0;e<o.X_TILES;e++)for(var t=0;t<o.Y_TILES;t++){var n=new r.default(e,t),i=void 0;i=(e+t)%2==0?o.BACKGROUND_COLOR_1:o.BACKGROUND_COLOR_2,this.gc.fillStyle=i,this.drawTile(n)}}},{key:"drawSnake",value:function(e){this.gc.fillStyle=o.SNAKE_COLOR;for(var t=0;t<e.snake.length;t++)this.drawTile(e.snake[t])}},{key:"drawApple",value:function(e,t){t?this.drawImageOnTile(this.appleImage,e):this.animateApple(e)}},{key:"animateApple",value:function(e){1==this.appleAnimationDirection?this.appleAnimationScale<120?this.appleAnimationScale+=1:this.appleAnimationDirection=-1:this.appleAnimationScale>80?this.appleAnimationScale-=1:this.appleAnimationDirection=1,this.drawImageOnTileWithScaleFactor(this.appleImage,e,.01*this.appleAnimationScale)}},{key:"drawImageOnTile",value:function(e,t){this.drawImageOnTileWithScaleFactor(e,t,1)}},{key:"drawImageOnTileWithScaleFactor",value:function(e,t,n){var i=t.x*this.tileWidth,a=t.y*this.tileHeight,s=this.tileWidth*n,r=this.tileHeight*n,o=i-(s-this.tileWidth)/2,u=a-(r-this.tileHeight)/2;this.gc.drawImage(e,o,u,s,r)}},{key:"drawTile",value:function(e){var t=e.x*this.tileWidth,n=e.y*this.tileHeight;this.gc.fillRect(t,n,this.tileWidth,this.tileHeight)}}]),e}();n.default=u},{"./game_config":5,"./tile":10}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=o(e("./apple")),s=o(e("./snake")),r=o(e("./tile"));function o(e){return e&&e.__esModule?e:{default:e}}var u=e("./game_config"),h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.HIGHSCORE_STORAGE_KEY="highscore",this.storageHandler=t,this.readStorageContents()}return i(e,[{key:"registerUiHandler",value:function(e){this.uiHandler=e}},{key:"readStorageContents",value:function(){this.highscore=this.storageHandler.get(this.HIGHSCORE_STORAGE_KEY,0)}},{key:"newGame",value:function(){this.score=0,this.paused=!0,this.gameover=!1,this.snake=new s.default,this.apple=new a.default(this.snake),this.dx=1,this.dy=0,this.uiHandler.updateUiControls()}},{key:"startPauseGame",value:function(){this.paused?this.startGame():this.pauseGame()}},{key:"startGame",value:function(){var e=this;this.gameover||this.paused&&(this.paused=!1,this.gameInterval=window.setInterval(function(){return e.game()},1e3/u.GAME_SPEED))}},{key:"pauseGame",value:function(){this.paused=!0,window.clearInterval(this.gameInterval)}},{key:"endGame",value:function(){this.pauseGame(),this.gameover=!0,this.uiHandler.showGameOverScreen()}},{key:"left",value:function(){this.paused&&this.startGame(),1!=this.snake.head().dx&&(this.dx=-1,this.dy=0)}},{key:"up",value:function(){this.paused&&this.startGame(),1!=this.snake.head().dy&&(this.startGame(),this.dx=0,this.dy=-1)}},{key:"right",value:function(){this.paused&&this.startGame(),-1!=this.snake.head().dx&&(this.startGame(),this.dx=1,this.dy=0)}},{key:"down",value:function(){this.paused&&this.startGame(),-1!=this.snake.head().dy&&(this.startGame(),this.dx=0,this.dy=1)}},{key:"game",value:function(){return u.ENABLE_WALLS&&this.snake.aboutToCollideWithWalls(this.dx,this.dy)?this.endGame():(r.default.collides(this.snake.head(),this.apple)&&(this.snake.eatApple(),this.apple=new a.default(this.snake),this.increaseScore(1)),this.snake.move(this.dx,this.dy),this.snake.loopThroughWalls(),this.snake.collidesWithItself()?this.endGame():void 0)}},{key:"increaseScore",value:function(e){this.score+=e,this.score>this.highscore&&this.setHighscore(this.score),this.uiHandler.updateUiControls()}},{key:"setHighscore",value:function(e){this.highscore=e,this.storageHandler.set(this.HIGHSCORE_STORAGE_KEY,this.highscore),this.uiHandler.updateUiControls()}},{key:"resetHighscore",value:function(){this.setHighscore(0)}}]),e}();n.default=h},{"./apple":1,"./game_config":5,"./snake":7,"./tile":10}],5:[function(e,t,n){"use strict";t.exports={ENABLE_WALLS:!0,INITIAL_SNAKE_SIZE:5,X_TILES:21,Y_TILES:21,BACKGROUND_COLOR_1:"#aed75b",BACKGROUND_COLOR_2:"#9fd24a",SNAKE_COLOR:"purple",GAME_SPEED:7,REFRESH_FPS:60}},{}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var a=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,window.addEventListener("keydown",function(e){return n.handleKeyEvent(e)})}return i(e,[{key:"handleKeyEvent",value:function(e){switch(e.key){case" ":case"Escape":case"Esc":case"p":this.game.startPauseGame();break;case"ArrowLeft":case"Left":case"a":this.game.left();break;case"ArrowUp":case"Up":case"w":this.game.up();break;case"ArrowRight":case"Right":case"d":this.game.right();break;case"ArrowDown":case"Down":case"s":this.game.down()}}}]),e}();n.default=a},{}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=r(e("./snake_body")),s=r(e("./tile"));function r(e){return e&&e.__esModule?e:{default:e}}var o=e("./game_config"),u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.snake=[];var t=new a.default;t.x=o.INITIAL_SNAKE_SIZE-1,t.y=Math.floor(o.Y_TILES/2),t.dx=1,t.dy=0,this.append(t);for(var n=1;n<o.INITIAL_SNAKE_SIZE;n++)this.append(new a.default(this.head().x-n,this.head().y,this.head().dx,this.head().dy))}return i(e,[{key:"head",value:function(){return this.snake[0]}},{key:"tail",value:function(){return this.snake[this.snake.length-1]}},{key:"move",value:function(e,t){this.prepend(new a.default(this.head().x+e,this.head().y+t,e,t)),this.dropLast()}},{key:"append",value:function(e){this.snake.push(e)}},{key:"prepend",value:function(e){this.snake.unshift(e)}},{key:"dropLast",value:function(){this.snake.pop()}},{key:"collidesWith",value:function(e){return this.bodyCollidesWith(e)||s.default.collides(this.head(),e)}},{key:"bodyCollidesWith",value:function(e){if(this.snake.length<2)return!1;for(var t=1;t<this.snake.length;t++)if(s.default.collides(this.snake[t],e))return!0;return!1}},{key:"collidesWithItself",value:function(){return this.bodyCollidesWith(this.head())}},{key:"loopThroughWalls",value:function(){this.head().x<0&&(this.snake[0].x=o.X_TILES-1),this.head().x>=o.X_TILES&&(this.snake[0].x=0),this.head().y<0&&(this.snake[0].y=o.Y_TILES-1),this.head().y>=o.Y_TILES&&(this.snake[0].y=0)}},{key:"aboutToCollideWithWalls",value:function(e,t){return this.head().x+e<0||(this.head().x+e>=o.X_TILES||(this.head().y+t<0||this.head().y+t>=o.Y_TILES))}},{key:"eatApple",value:function(){var e=this.tail();this.append(new a.default(e.x+e.dx,e.y+e.dy,e.dx,e.dy))}}]),e}();n.default=u},{"./game_config":5,"./snake_body":8,"./tile":10}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i,a=e("./tile"),s=(i=a)&&i.__esModule?i:{default:i};var r=function(e){function t(e,n,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return s.dx=i,s.dy=a,s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.default),t}();n.default=r},{"./tile":10}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.KEY_PREFIX="snake",this.KEY_SEPARATOR="###"}return i(e,[{key:"get",value:function(e,t){return window.localStorage.getItem(this.KEY_PREFIX+this.KEY_SEPARATOR+e)||t}},{key:"set",value:function(e,t){window.localStorage.setItem(this.KEY_PREFIX+this.KEY_SEPARATOR+e,t)}}]),e}();n.default=a},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var a=e("./game_config"),s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),null==t&&null==n?this.randomize():(this.x=t,this.y=n)}return i(e,null,[{key:"collides",value:function(e,t){return e.x===t.x&&e.y===t.y}}]),i(e,[{key:"randomize",value:function(){this.x=Math.floor(a.X_TILES*Math.random()),this.y=Math.floor(a.Y_TILES*Math.random())}}]),e}();n.default=s},{"./game_config":5}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var a=function(){function e(t,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=document.getElementById(t),this.game=n,n.touchStartX=null,n.touchStartY=null,n.touchMoveX=null,n.touchMoveY=null,this.canvas.addEventListener("touchstart",function(e){return i.handleTouchStart(e)},!1),this.canvas.addEventListener("touchmove",function(e){return i.handleTouchMove(e)},!1)}return i(e,[{key:"handleTouchStart",value:function(e){this.touchStartX=e.touches[0].clientX,this.touchStartY=e.touches[0].clientY}},{key:"handleTouchMove",value:function(e){null!=this.touchStartX&&null!=this.touchStartY&&(this.touchMoveX=e.touches[0].clientX,this.touchMoveY=e.touches[0].clientY,this.handleTouchGesture(),this.touchStartX=this.touchMoveX,this.touchStartY=this.touchMoveY)}},{key:"handleTouchGesture",value:function(){var e=this.touchMoveX-this.touchStartX,t=this.touchMoveY-this.touchStartY;Math.abs(e)>Math.abs(t)?e<0?this.game.left():e>0&&this.game.right():Math.abs(e)<Math.abs(t)&&(t<0?this.game.up():t>0&&this.game.down())}}]),e}();n.default=a},{}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.gameWasRunning=!1,this.uiControls={OVERLAY:document.getElementById("js-overlay"),GAMEOVER_SCREEN:document.getElementById("js-gameover-screen"),GAMEOVER_SCREEN_BUTTON:document.getElementById("js-gameover-screen-button"),UI_CONTROLS_BAR:document.getElementById("js-ui-controls"),SCORE_LABEL:document.getElementById("js-score"),HIGHSCORE_LABEL:document.getElementById("js-highscore"),MENU_BUTTON:document.getElementById("js-menu-button"),MENU:document.getElementById("js-menu"),MENU_RESET_HIGHSCORE:document.getElementById("js-menu-reset-highscore")},this.setUpEventHandlers()}return i(e,[{key:"setUpEventHandlers",value:function(){var e=this;this.uiControls.GAMEOVER_SCREEN_BUTTON.addEventListener("click",function(){return e.newGame()}),this.uiControls.MENU_BUTTON.addEventListener("click",function(){return e.showMenu()}),this.uiControls.MENU_RESET_HIGHSCORE.addEventListener("click",function(){return e.resetHighscore()})}},{key:"updateUiControls",value:function(){this.updateScore(),this.updateHighscore()}},{key:"updateScore",value:function(){this.uiControls.SCORE_LABEL.innerHTML=this.game.score}},{key:"updateHighscore",value:function(){this.uiControls.HIGHSCORE_LABEL.innerHTML=this.game.highscore}},{key:"resetHighscore",value:function(){this.game.resetHighscore(),this.hideMenu()}},{key:"showOverlay",value:function(e){this.uiControls.OVERLAY.classList.add("overlay-shown"),null!=e&&this.uiControls.OVERLAY.addEventListener("click",e)}},{key:"hideOverlay",value:function(){this.uiControls.OVERLAY.classList.remove("overlay-shown");var e=this.uiControls.OVERLAY.cloneNode(!0);this.uiControls.OVERLAY.parentNode.replaceChild(e,this.uiControls.OVERLAY),this.uiControls.OVERLAY=e}},{key:"showMenu",value:function(){var e=this;this.gameWasRunning=!this.game.paused,this.game.pauseGame(),this.showOverlay(function(){return e.hideMenu()}),this.uiControls.MENU.classList.add("menu-shown")}},{key:"hideMenu",value:function(){this.hideOverlay(),this.uiControls.MENU.classList.remove("menu-shown"),this.gameWasRunning&&this.game.startGame()}},{key:"showGameOverScreen",value:function(){this.showOverlay(),this.uiControls.GAMEOVER_SCREEN.classList.add("gameover-screen-shown")}},{key:"newGame",value:function(){this.hideOverlay(),this.uiControls.GAMEOVER_SCREEN.classList.remove("gameover-screen-shown"),this.game.newGame()}}]),e}();n.default=a},{}]},{},[2]);